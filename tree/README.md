# Tree module

## Goal

The tree module provides:
- a `tree` package which standardises the tree data structure used by the `codegen` package
- a `defaultparser` package which is a parser that can parse a string into a tree. This parser is both a default parser to be used by pergolator users and an example of how to create a custom parser. It was created as an exercise to write a parser manually, For other parsers I would recommend using [participle](https://github.com/alecthomas/participle) or [PEG](https://pegn.dev/).

It is decoupled from the main module containing `codegen` and `tests` to have independent lifecycle and dependency management.

As it is used by the code generated by `codegen`, it will be imported in the repositories using pergolator, and we want to reduce the number of indirect dependencies we introduce, so we require it to:
- have no external dependencies
- use only the standard library 


## Usage

### `tree` package
The `tree` package is meant to be used:
- by developers to create custom parsers
- by the final code generated by `codegen`

### `defaultparser` package

The `defaultparser` package is meant to be used by developers when they create a new percolator without having their own parser.

Example:

```go
package main

import (
	"github.com/mchenriques22/pergolator/tree/defaultparser"
)

func main(){
	query := "key1:value1 AND key2:value2"
	
	// We assume here that a `StructPercolator` has been generated by the `codegen` package
	percolator, err := NewStructPercolator(defaultparser.Parse, query)
	if err != nil {
		panic(err)
	}
	
	// Do something with the percolator
	s := Struct{
        Key1: "value1",
        Key2: "value2",
    }
	
	if percolator.Percolate(s) { 
           // Do something 
	}
}
```

To have a complete description of the query language supported by the default parser, please refer to its [specification](defaultparser/SPEC.md).
